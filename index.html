<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>A2Z Dorkary – Shop</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    :root{
      --primary:#0b66ff; --navy:#0d2847; --navy-2:#0b2140; --line:#e6eaf0;
      --danger:#d32f2f; --ok:#28a745; --badge:#0b66ff; --green:#10b981;
      --wrap:1200px; /* central max-width */
    }

    *{box-sizing:border-box}
    /* ===== Global font changed to Times New Roman ===== */
    body{
      margin:0;
      font-family:"Times New Roman", Times, serif;
      background:#f5f6f8;
      color:#111;
    }

    /* simple container so the grid never leaks outside the page */
    .container{
      max-width:var(--wrap);
      margin:0 auto;
      padding:0 16px;
      width:100%;
    }

    .header{display:flex;align-items:center;gap:18px;padding:12px 20px;background:#fff;border-bottom:1px solid #e6e6e6;position:sticky;top:0;z-index:100}
    .logo{display:flex;align-items:center;gap:10px;text-decoration:none;color:#0b2447;font-weight:800;font-size:20px;white-space:nowrap}
    .logo img{width:32px;height:32px;object-fit:contain;border-radius:50%;background:#fff;outline:2px solid var(--primary)}

    .search-wrap{flex:1;display:flex;justify-content:center}
    .searchbar{display:flex;align-items:center;width:100%;max-width:720px;border:1px solid var(--line);border-radius:10px;overflow:hidden;background:#fff}
    .search-cat-wrap{position:relative}
    .search-cat{display:flex;align-items:center;gap:8px;padding:10px 14px;cursor:pointer;min-width:84px;background:#fff;border-right:1px solid var(--line);font-size:14px}
    .search-cat i{font-size:12px;color:#2c3e50}
    .search-cat-menu{position:absolute;left:0;top:100%;margin-top:8px;min-width:160px;background:#fff;border:1px solid var(--line);border-radius:10px;box-shadow:0 10px 20px rgba(0,0,0,.08);display:none;overflow:auto;max-height:260px;z-index:99}
    .search-cat-menu li{list-style:none;padding:10px 12px;cursor:pointer;border-bottom:1px solid #f3f5f8;font-size:14px}
    .search-cat-menu li:last-child{border-bottom:none}
    .search-cat-menu li:hover{background:#f1f6ff}
    .search-inner{display:flex;align-items:center;gap:10px;flex:1;padding:0 10px}
    .search-inner .fa-magnifying-glass{color:#314267;font-size:18px}
    .search-input{flex:1;border:none;outline:none;font-size:14px;padding:10px 0;color:#1e293b}
    .search-input::placeholder{color:#97a3b7}
    .search-btn{background:var(--primary);color:#fff;border:none;height:100%;padding:10px 22px;font-weight:800;cursor:pointer;border-left:1px solid #0b233e}
    .search-btn:hover{background:#0a57db}

    .toolbar{display:flex;align-items:center;gap:22px;position:relative}
    .account{display:flex;align-items:center;gap:8px;color:#1f2a44;text-decoration:none;white-space:nowrap}
    .account .fa-user{font-size:20px;color:#0f1f39}
    .account .mini{font-size:11px;color:#7b88a8;display:block;line-height:1}
    .account .title{font-size:14px;font-weight:700;line-height:1.1}
    .icon-btn{position:relative;text-decoration:none;color:#0b1630;display:flex;align-items:center;border:none;background:transparent;cursor:pointer}
    .icon-btn i{font-size:20px}
    .badge{position:absolute;top:-6px;right:-9px;min-width:16px;height:16px;padding:0 3px;border-radius:10px;background:var(--badge);color:#fff;display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:800;border:2px solid #fff}
    .cart-total{font-size:13px;color:#1a2547;white-space:nowrap}
    .cart-total strong{font-weight:800}

    .navbar{display:flex;align-items:center;gap:20px;padding:12px 20px;background:#f8f8f8;border-bottom:1px solid #e6e6e6}
    .all-categories{background:var(--primary);color:#fff;padding:10px 16px;border-radius:6px;display:flex;align-items:center;gap:10px;cursor:pointer;position:relative;user-select:none}
    .nav-links{margin-left:3cm;display:flex;gap:18px}
    .nav-links a{position:relative;text-decoration:none;color:#222;font-weight:600;padding-bottom:6px;background-image:linear-gradient(var(--primary),var(--primary));background-repeat:no-repeat;background-position:left calc(100% - 0px);background-size:0% 3px;transition:background-size .35s}
    .nav-links a:hover{background-size:100% 3px}
    .nav-links a.active{background-size:100% 3px}

    .dropdown{display:none;position:absolute;top:56px;left:12px;width:560px;background:#fff;border:1px solid #e3e3e3;border-radius:12px;box-shadow:0 12px 30px rgba(20,20,20,.12);padding:10px;z-index:90;max-height:70vh;overflow:auto}
    .dropdown.anim-open{display:block;animation:shutter .35s ease forwards;clip-path:inset(0 0 100% 0)}
    @keyframes shutter{to{clip-path:inset(0 0 0 0)}}
    .dropdown .cat-list{list-style:none;margin:0;padding:0}
    .dropdown .cat-item{padding:10px;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:space-between;gap:8px;transition:background .2s}
    .dropdown .cat-item:hover{background:#f7faff}
    .dropdown .label{display:flex;gap:8px;align-items:center;flex:1;color:#222}
    .dropdown .caret{font-size:12px;color:#666;margin-left:8px}
    .hidden{display:none!important}
    .submenu{overflow:hidden;max-height:0;opacity:0;margin-left:14px;border-left:2px solid #f0f0f0;padding-left:10px;transition:max-height .45s,opacity .45s,margin-top .45s;margin-top:0}
    .cat-item.open>.submenu{max-height:1200px;opacity:1;margin-top:8px}
    .submenu,.submenu *{color:#000}

    /* Success toast after add-to-cart */
    .cart-toast{
      position:fixed; top:66px; right:18px; z-index:120;
      display:none; align-items:center; gap:10px;
      background:#f2fff7; color:#0f5132; border:1px solid #cfead9;
      padding:10px 14px; border-radius:10px; box-shadow:0 6px 18px rgba(0,0,0,.06);
      font-size:14px; font-weight:700;
    }
    .cart-toast.show{ display:flex; animation:fadeStay 2.2s ease }
    @keyframes fadeStay{
      0%{opacity:0; transform:translateY(-6px)}
      10%{opacity:1; transform:translateY(0)}
      90%{opacity:1}
      100%{opacity:0}
    }

    .page{display:none;padding:16px 0}
    .page.show{display:block}

    /* ======= PRODUCTS GRID ======= */
    .products{padding:20px 0;display:grid;grid-template-columns:repeat(4,1fr);gap:20px}
    .product-card{background:#fff;border-radius:10px;border:1px solid #e6e6e6;padding:12px;display:flex;flex-direction:column;min-height:380px;box-shadow:0 2px 10px rgba(0,0,0,.02)}
    .product-image{position:relative;width:100%;height:170px;display:flex;align-items:center;justify-content:center}
    .product-image img{max-width:100%;max-height:100%;object-fit:contain;border-radius:6px;background:#fff}
    /* wishlist heart inside image top-right */
    .wish-btn{position:absolute;top:8px;right:8px;width:34px;height:34px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:#ffffffd9;border:1px solid #eaeaea;cursor:pointer}
    .wish-btn i{font-size:16px;color:#666;transition:transform .2s}
    .wish-btn.active i{color:#e11d48}
    .wish-btn:active i{transform:scale(.9)}

    .divider{height:1px;background:#eef1f6;margin:12px 0}

    .product-title{font-size:15px;font-weight:700;margin-top:0;color:#0b66ff;min-height:44px;text-decoration:none}
    .product-title:hover{opacity:.9}
    .feature-list{margin:8px 0 0 0;padding-left:18px;color:#24324a;font-size:13px;line-height:1.6}
    .feature-list li{margin:2px 0}

    .price-area{margin-top:10px;display:flex;align-items:center;gap:10px}
    .regular-price{text-decoration:line-through;color:#9aa1b5;font-size:13px}
    .discount-price{color:var(--danger);font-weight:800;font-size:16px}

    /* Bottom wrapper so price + buttons stick to card bottom (alignment like your screenshots) */
    .product-bottom{margin-top:auto}
    /* Buttons row (Add left, View right) */
    .product-actions{margin-top:12px;display:flex;gap:10px;justify-content:space-between;align-items:stretch}
    .btn{padding:10px 12px;border-radius:8px;border:1px solid transparent;cursor:pointer;font-weight:700;font-size:13px;flex:1 1 0;min-width:120px;position:relative;overflow:hidden;isolation:isolate;display:flex;align-items:center;justify-content:center;gap:8px;text-decoration:none}
    .btn-blue{background:var(--primary);color:#fff;border-color:var(--primary)}
    .btn-blue::before{content:"";position:absolute;inset:0;background:var(--green);transform:translateX(-100%);transition:transform 2s ease;z-index:-1;border-radius:inherit;}
    .btn-blue:hover::before{transform:translateX(0)}
    .btn-view{background:var(--primary);color:#fff;border-color:var(--primary);text-align:center;text-decoration:none}
    .btn-view::before{content:"";position:absolute;inset:0;background:var(--green);transform:translateX(-100%);transition:transform 2s ease;z-index:-1;border-radius:inherit;}
    .btn-view:hover::before{transform:translateX(0)}

    .overlay{position:fixed;inset:0;background:rgba(0,0,0,.25);display:none;z-index:120}
    .overlay.show{display:block}
    .drawer{position:fixed;top:0;right:0;width:380px;max-width:90vw;height:100vh;background:#fff;border-left:1px solid #e5e9f2;box-shadow:0 14px 34px rgba(0,0,0,.14);transform:translateX(100%);transition:transform .35s;z-index:130;display:flex;flex-direction:column}
    .drawer.open{transform:translateX(0)}
    .drawer-header{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:10px 14px;border-bottom:1px solid #eef2f7;background:#f8fafc;font-weight:700}
    .drawer-body{padding:10px 14px;overflow:auto}
    .drawer-spacer{height:4cm}
    .drawer-footer{border-top:1px solid #eef2f7;padding:14px;background:#fff}
    .subtotal{font-weight:800;text-align:center;margin-bottom:10px}
    .view-cart-btn{width:100%;background:#000;color:#fff;border:none;padding:12px 14px;border-radius:6px;font-weight:700;cursor:pointer}

    .mc-item{display:flex;align-items:flex-start;gap:10px;padding:10px 0;border-bottom:1px dashed #eef1f6}
    .mc-thumb{width:60px;height:60px;border:1px solid #edf1f6;border-radius:8px;display:flex;align-items:center;justify-content:center;overflow:hidden;background:#fff}
    .mc-thumb img{max-width:100%;max-height:100%;object-fit:contain}
    .mc-meta{flex:1}.mc-title{font-size:13px;font-weight:700;line-height:1.3;margin-bottom:6px}
    .mc-line{font-size:12px;color:#566074}
    .mc-remove{color:#0b2447;cursor:pointer;padding:6px 8px}
    .qty-input{width:58px;padding:6px 6px;border:1px solid #dfe5f0;border-radius:8px;font-size:12px}

    .cart-layout{display:grid;grid-template-columns:1fr 340px;gap:20px}
    .cart-card{background:#fff;border:1px solid #e6e6e6;border-radius:8px}
    .cart-head{padding:10px 14px;background:#f1f3f7;border-bottom:1px solid #e6e6e6;font-weight:700;display:flex;align-items:center;justify-content:space-between}
    .cart-row{display:grid;grid-template-columns:30px 80px 1fr 190px 40px;align-items:center;gap:10px;padding:12px 14px;border-bottom:1px solid #f1f3f6}
    .cart-row img{width:70px;height:70px;object-fit:contain;border:1px solid #eef1f6;border-radius:6px;background:#fff}
    .cart-qty{display:inline-flex;align-items:center;gap:0;border:1px solid #dfe5f0;border-radius:6px;overflow:hidden}
    .cart-qty button{width:28px;height:28px;border:none;background:#f4f6fa;cursor:pointer}
    .cart-qty input{width:38px;height:28px;border:none;text-align:center;outline:none}
    .trash-btn{background:none;border:none;cursor:pointer;color:#333}
    .price-box{background:#fff;border:1px solid #e6e6e6;border-radius:8px}
    .price-head{padding:10px 14px;background:#f1f3f7;border-bottom:1px solid #e6e6e6;font-weight:700}
    .price-body{padding:12px 14px}
    .price-row{display:flex;align-items:center;justify-content:space-between;padding:8px 0;border-bottom:1px dashed #e9edf3}
    .price-row:last-child{border-bottom:none}
    .act-btn{width:100%;padding:12px;border:none;border-radius:6px;font-weight:700;cursor:pointer}
    .btn-dark{background:#000;color:#fff;margin-bottom:10px}
    .btn-blue--solid{background:var(--primary);color:#fff}
    .btn-disabled{opacity:.5;cursor:not-allowed}

    .link{color:#0b66ff;text-decoration:none}
    .link:hover{text-decoration:underline}
    .row-price{min-width:70px;text-align:right}
    .breadcrumbs{display:flex;align-items:center;gap:8px;color:#3b4862;font-weight:700;margin:6px 0 12px 0}
    .text-delete{background:#f4f6fa;border:1px solid #e6e6e6;padding:6px 12px;border-radius:6px;cursor:pointer}
    .text-delete:hover{background:#ffecec;border-color:#ffd0d0}

    @media (max-width:1200px){.products{grid-template-columns:repeat(3,1fr)}.cart-layout{grid-template-columns:1fr}}
    @media (max-width:1000px){.products{grid-template-columns:repeat(2,1fr)}.nav-links{margin-left:10px}.dropdown{left:10px;width:420px}}
    @media (max-width:640px){.products{grid-template-columns:1fr}.navbar{padding:12px 10px}.search-btn{padding:10px 14px}.dropdown{width:320px}}

    /* ======= HOME (slider) – scoped with hb- prefix ======= */
    .hb-wrap{padding:16px}
    .hb-grid{display:grid;gap:14px;grid-template-columns:2fr 1fr;grid-template-rows:auto auto;align-items:stretch}
    .hb-slider{position:relative;overflow:hidden;border-radius:12px;border:1px solid #e6e6e6;background:#fff;height:300px;grid-row:1/3;grid-column:1/2}
    .hb-track{display:flex;height:100%;will-change:transform;transition:transform 600ms ease}
    .hb-slide{flex:0 0 100%;height:100%}
    .hb-slide img{width:100%;height:100%;object-fit:cover;display:block}
    .hb-arrow{position:absolute;top:50%;transform:translateY(-50%);width:38px;height:38px;border-radius:999px;display:flex;align-items:center;justify-content:center;border:none;cursor:pointer;background:rgba(0,0,0,.35);color:#fff;transition:opacity .2s}
    .hb-arrow:hover{opacity:.9}
    .hb-prev{left:10px}.hb-next{right:10px}
    .hb-side{display:block;border-radius:12px;overflow:hidden;border:1px solid #e6e6e6;background:#fff}
    .hb-side img{width:100%;height:100%;object-fit:cover;display:block}
    .hb-top{grid-column:2/3;grid-row:1/2;height:144px}
    .hb-bottom{grid-column:2/3;grid-row:2/3;height:144px}
    @media(max-width:900px){.hb-grid{grid-template-columns:1fr;grid-template-rows:auto auto auto}.hb-slider{grid-row:auto;grid-column:auto;height:240px}.hb-top,.hb-bottom{height:120px}}

    /* ======= Back circle button (left of heading) ======= */
    .back-circle{
      width:36px;height:36px;border-radius:999px;border:1px solid #d7dbe5;background:#fff;
      display:inline-flex;align-items:center;justify-content:center;margin-right:8px;cursor:pointer;
      box-shadow:0 2px 6px rgba(0,0,0,.04);
    }
    .back-circle .arrow{display:inline-block;transition:transform .3s ease}
    .back-circle:hover .arrow{animation:pulseZoom 1s ease-in-out infinite}
    @keyframes pulseZoom{
      0%{transform:scale(1)}
      50%{transform:scale(1.15)}
      100%{transform:scale(1)}
    }

    /* ======= Wishlist popover ======= */
    .wish-pop{
      position:absolute; right:0; top:120%;
      /* ★ update: bigger drawer for clear visibility */
      width:520px; max-height:70vh; /* was 320px / 380px */
      overflow:auto;
      background:#fff; border:1px solid #e6e6e6; border-radius:10px;
      box-shadow:0 10px 24px rgba(0,0,0,.10); display:none; z-index:120;
    }
    .wish-pop.show{display:block}
    .wish-pop .head{padding:10px 12px;border-bottom:1px solid #eef1f6;font-weight:800}
    .wish-pop .row{display:flex;gap:10px;padding:10px 12px;border-bottom:1px dashed #eef1f6;align-items:center}
    .wish-pop .row:last-child{border-bottom:none}
    /* ★ update: slightly larger thumbnails */
    .wish-pop img{width:64px;height:64px;object-fit:contain;border:1px solid #eef1f6;border-radius:6px;background:#fff}
    .wish-pop .title{font-size:13px;font-weight:700}
    .wish-pop .rm{margin-left:auto;border:none;background:#f4f6fa;border:1px solid #e6e6e6;padding:6px 8px;border-radius:6px;cursor:pointer}
    /* header heart turns red when wishlist has items */
    .has-wish > i.fa-heart{color:#e11d48}
  </style>
</head>
<body>
  <!-- =================== HEADER =================== -->
  <div class="header">
    <a class="logo" href="#" id="homeLink">
      <img src="https://dummyimage.com/64x64/ffffff/0b66ff.png&text=A" alt="A2Z Dorkary">
      <span style="color:#0b66ff;">A2Z Dorkary</span>
    </a>

    <div class="search-wrap">
      <div class="searchbar">
        <div class="search-cat-wrap">
          <div id="searchCat" class="search-cat">
            <span id="searchCatLabel">All</span><i class="fa fa-chevron-down"></i>
          </div>
          <ul id="searchCatMenu" class="search-cat-menu">
            <li data-value="All">All</li>
            <li data-value="Motherboard">Motherboard</li>
            <li data-value="Processor">Processor</li>
            <li data-value="RAM">RAM</li>
            <li data-value="SSD">SSD</li>
            <li data-value="Monitor">Monitor</li>
          </ul>
        </div>
        <div class="search-inner">
          <i class="fa fa-magnifying-glass"></i>
          <input id="searchBox" class="search-input" type="text" placeholder="Search your favorite product..." />
        </div>
        <button id="searchBtn" class="search-btn">Search</button>
      </div>
    </div>

    <div class="toolbar">
      <a class="account" href="#"><i class="fa fa-user"></i><span><span class="mini">Sign In</span><span class="title">Account</span></span></a>

      <!-- Wishlist icon + popover -->
      <button class="icon-btn" id="wishIconBtn" title="Wishlist">
        <i class="fa fa-heart"></i><span id="wishCount" class="badge">0</span>
        <div id="wishPop" class="wish-pop" aria-hidden="true">
          <div class="head">Wishlist</div>
          <div id="wishBody"></div>
        </div>
      </button>

      <button id="cartBtn" type="button" class="icon-btn" aria-expanded="false" title="Cart">
        <i class="fa fa-shopping-cart"></i><span id="cartCount" class="badge">0</span>
      </button>

      <div class="cart-total">Total<br><strong id="cartTotal">৳0.00</strong></div>
    </div>
  </div>

  <!-- success toast -->
  <div id="cartToast" class="cart-toast"><i class="fa-solid fa-circle-check"></i> New items added successfully</div>

  <!-- =================== NAVBAR =================== -->
  <div class="navbar">
    <div class="all-categories" id="allCategoriesBtn" role="button" aria-expanded="false" aria-controls="dropdownMenu">
      <i class="fa fa-bars"></i><span style="margin-left:6px;">All Categories</span><i class="fa fa-angle-down" style="margin-left:6px;"></i>
      <div class="dropdown" id="dropdownMenu" aria-hidden="true">
        <ul class="cat-list" id="catList">
          <li class="cat-item" data-shop="Electronics Shop"><div class="label"><i class="fa fa-tv" style="color:#777"></i><span>Electronics Shop</span></div></li>
          <li class="cat-item has-children" data-shop="Computer Shop" id="computerShopNode">
            <div class="label"><i class="fa fa-desktop" style="color:#777"></i><span>Computer Shop</span><i class="fa fa-angle-right caret"></i></div>
            <div class="submenu">
              <div class="cat-item has-children" data-cat="Motherboard" id="motherboardNode">
                <div class="label"><span>Motherboard</span><i class="fa fa-angle-right caret"></i></div>
                <div class="submenu">
                  <div class="cat-item" data-cat="Motherboard" data-brand="Gigabyte"><div class="label">Gigabyte</div></div>
                  <div class="cat-item" data-cat="Motherboard" data-brand="MSI"><div class="label">MSI</div></div>
                  <div class="cat-item" data-cat="Motherboard" data-brand="ASUS"><div class="label">ASUS</div></div>
                  <div class="cat-item" data-cat="Motherboard" data-brand="ASRock"><div class="label">ASRock</div></div>
                </div>
              </div>
              <div class="cat-item" data-cat="Processor"><div class="label">Processor</div><i class="fa fa-angle-right caret"></i></div>
              <div class="cat-item" data-cat="RAM"><div class="label">RAM</div><i class="fa fa-angle-right caret"></i></div>
              <div class="cat-item" data-cat="SSD"><div class="label">SSD</div><i class="fa fa-angle-right caret"></i></div>
              <div class="cat-item" data-cat="Monitor"><div class="label">Monitor</div><i class="fa fa-angle-right caret"></i></div>
            </div>
          </li>
          <li class="cat-item" data-shop="Dress Shop"><div class="label"><i class="fa fa-shirt" style="color:#777"></i><span>Dress Shop</span></div></li>
          <li class="cat-item" data-shop="Grocery Shop"><div class="label"><i class="fa fa-basket-shopping"></i><span>Grocery Shop</span></div></li>
          <li class="cat-item" data-shop="Jewellary Shop"><div class="label"><i class="fa fa-gem"></i><span>Jewellary Shop</span></div></li>
          <li class="cat-item" data-shop="Gadget Shop"><div class="label"><i class="fa fa-plug"></i><span>Gadget Shop</span></div></li>
        </ul>
      </div>
    </div>

    <div class="nav-links">
      <a href="#" id="navHome" class="active">Home</a>
      <a href="#" id="navShop">Shop</a>
      <a href="#" id="navProducts">Products</a>
    </div>
  </div>

  <!-- =================== PAGES =================== -->
  <main id="homePage" class="page show">
    <section id="homeBanners" class="hb-wrap container">
      <div class="hb-grid">
        <div class="hb-slider">
          <div class="hb-track" id="hbTrack"></div>
          <button class="hb-arrow hb-prev" id="hbPrev" aria-label="Previous">&#10094;</button>
          <button class="hb-arrow hb-next" id="hbNext" aria-label="Next">&#10095;</button>
        </div>
        <a id="hbRightTop" class="hb-side hb-top" href="#" target="_self"><img src="" alt=""></a>
        <a id="hbRightBottom" class="hb-side hb-bottom" href="#" target="_self"><img src="" alt=""></a>
      </div>
    </section>
  </main>

  <section id="shopPage" class="page">
    <div class="container" style="padding:24px 0;font-size:22px;font-weight:800;color:#0b66ff">Welcome to Shop Page</div>
  </section>

  <section id="productsPage" class="page">
    <div class="container">
      <!-- heading + back button -->
      <div style="display:flex;align-items:center;gap:8px;margin:6px 0 8px">
        <div id="backBtn" class="back-circle" title="Back">
          <i class="fa fa-arrow-left arrow"></i>
        </div>
        <h3 style="color:#111;margin:0">Computer Accessories</h3>
      </div>
      <section class="products" id="productsGrid"></section>
    </div>
  </section>

  <!-- ===== Cart Page ===== -->
  <section id="cartPage" class="page">
    <div class="container">
      <div class="breadcrumbs">
        <a href="#" id="bcHome" class="link"><i class="fa fa-house"></i></a>
        <i class="fa fa-arrow-right-long"></i>
        <span>Cart</span>
      </div>

      <div class="cart-layout">
        <div class="cart-card">
          <div class="cart-head">
            <span>You have (<span id="cpCount">0</span>) items in your cart</span>
            <div style="display:flex;align-items:center;gap:10px">
              <button id="bulkDelete" class="text-delete">Delete</button>
            </div>
          </div>

          <div style="padding:12px 14px">
            <label style="display:flex;align-items:center;gap:10px;margin-bottom:6px">
              <input type="checkbox" id="checkAll"> <strong>Check All</strong>
            </label>
          </div>
          <div id="cpRows"></div>
        </div>

        <div class="price-box">
          <div class="price-head">Price Details</div>
          <div class="price-body">
            <div class="price-row"><span>Regular Price</span><strong id="pdRegular">Tk 0</strong></div>
            <div class="price-row"><span>Product Discount</span><strong id="pdDisc">Tk 0</strong></div>
            <div class="price-row"><span>After Discount Product Cost</span><strong id="pdAfter">Tk 0</strong></div>
            <div class="price-row"><span>Shipping Cost</span><strong id="pdShip">Tk 0</strong></div>
            <div class="price-row"><span>Total</span><strong id="pdTotal">Tk 0</strong></div>
          </div>
          <div style="padding:14px">
            <button class="act-btn btn-dark" id="btnContinue">Continue Shopping</button>
            <button class="act-btn btn-blue--solid btn-disabled" id="btnCheckout" disabled>Checkout</button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- ===== Address Page ===== -->
  <section id="addressPage" class="page">
    <div class="container">
      <div style="padding:24px 0 6px;font-size:22px;font-weight:800;color:#0b66ff">Address</div>
      <div style="color:#667085">This page activates only after items are checked in Cart and you click Checkout.</div>
    </div>
  </section>

  <!-- =================== MINI CART DRAWER =================== -->
  <div id="overlay" class="overlay"></div>
  <aside id="drawer" class="drawer" aria-hidden="true">
    <div class="drawer-header">
      <span><i class="fa fa-shopping-cart"></i> Cart (<span id="drCount">0</span>)</span>
      <button id="drawerClose" class="trash-btn" title="Close"><i class="fa fa-times"></i></button>
    </div>
    <div id="drBody" class="drawer-body"></div>
    <div class="drawer-spacer"></div>
    <div class="drawer-footer">
      <div class="subtotal">Sub Total: <span id="drSubtotal">Tk 0</span></div>
      <button class="view-cart-btn" id="viewCartFromDrawer">View Cart</button>
    </div>
  </aside>

  <script>
    /* ===================== DATA ===================== */
    const products=[
      {
        id:"p5",
        name:"MSI G244F E2 23.8 inch FHD Rapid IPS 180Hz Gaming Monitor",
        brand:"MSI",
        category:"Monitor",
        image:"https://www.startech.com.bd/image/cache/catalog/monitor/msi/g244f-e2/g244f-e2-01-500x500.webp",
        regularPrice:22900, discountPrice:22900,
        features:[
          "Resolution: FHD (1920 × 1080)",
          "Display: IPS, 180Hz, 1ms (GTG)",
          "Ports: 2 × HDMI, 1 × DisplayPort, 1 × Earphone out",
          "Features: VESA Mountable, Adaptive-Sync"
        ]
      },
      {
        id:"p2",
        name:"MSI A520M-A Pro AM4 Micro-ATX Motherboard",
        brand:"MSI", category:"Motherboard",
        image:"https://www.startech.com.bd/image/cache/catalog/motherboard/msi/a520m-a-pro/a520m-a-pro-500x500.jpg",
        regularPrice:8800, discountPrice:8100,
        features:[
          "Chipset: AMD A520",
          "Form Factor: Micro-ATX",
          "Memory: 2× DDR4 up to 4600+ (OC)",
          "Storage: M.2 + SATA 6Gb/s"
        ]
      },
      {
        id:"p3",
        name:"ASRock B450M-HDV R4.0 AMD Motherboard",
        brand:"ASRock", category:"Motherboard",
        image:"https://www.startech.com.bd/image/cache/catalog/motherboard/asrock/b450m-hdv-r4/b450m-hdv-r4-500x500.jpg",
        regularPrice:8500, discountPrice:7900,
        features:[
          "Socket: AM4",
          "Memory: 2× DDR4 up to 3200+ (OC)",
          "Graphics: 1× PCIe 3.0 x16",
          "Storage: M.2 NVMe + 4× SATA3"
        ]
      },
      {
        id:"p4",
        name:"ASRock A520M-HVS AMD AM4 Micro ATX Motherboard",
        brand:"ASRock", category:"Motherboard",
        image:"https://www.startech.com.bd/image/cache/catalog/motherboard/asrock/a520m-hvs/a520m-hvs-01-500x500.webp",
        regularPrice:8500, discountPrice:7900,
        features:[
          "Socket: AM4",
          "Form Factor: Micro-ATX",
          "Audio: 7.1 CH HD Audio",
          "Storage: M.2 + SATA 6Gb/s"
        ]
      },
      {
        id:"p1",
        name:"Intel Core i5-7640X + ASUS TUF X299 MARK 2 Combo",
        brand:"Intel", category:"Processor",
        image:"https://www.startech.com.bd/image/cache/catalog/processor/Intel/i5-7640x-tuf-x299-mark-2-combo/i5-7640x-tuf-x299-mark-2-500x500.webp",
        regularPrice:56000, discountPrice:50000,
        features:[
          "CPU: Core i5-7640X (4C/4T, up to 4.2GHz)",
          "Board: ASUS TUF X299 MARK 2",
          "Memory: Quad-Channel Support",
          "Warranty: Limited 3 Years"
        ]
      }
    ];

    const PRODUCT_PAGE_URL = "product.html";

    const fmt=n=>"৳"+Number(n||0).toLocaleString("en-US");
    const fmtTk=n=>"Tk "+Number(n||0).toLocaleString("en-US");
    const byId=id=>products.find(p=>p.id===id);
    const unitPrice=p=>(p.discountPrice||p.regularPrice||0);

    /* ===================== SPA NAV ===================== */
    const pages={home:qs('#homePage'),shop:qs('#shopPage'),products:qs('#productsPage'),cart:qs('#cartPage'),address:qs('#addressPage')};
    const nav={home:qs('#navHome'),shop:qs('#navShop'),products:qs('#navProducts')};
    const LAST_PAGE_KEY='a2z_last_page';

    function showPage(key){
      Object.values(pages).forEach(p=>p.classList.remove('show'));
      pages[key].classList.add('show');
      Object.values(nav).forEach(a=>a.classList.remove('active'));
      if(nav[key]) nav[key].classList.add('active');
      if(key==='products') renderProducts(products, qs('#productsGrid'));
      if(key==='cart') renderCartPage();
      window.scrollTo({top:0,behavior:'smooth'});
      // persist last page so reload returns here
      try{ localStorage.setItem(LAST_PAGE_KEY,key); }catch(e){}
    }
    qs('#homeLink').addEventListener('click',e=>{e.preventDefault();showPage('home')});
    nav.home.addEventListener('click',e=>{e.preventDefault();showPage('home')});
    nav.shop.addEventListener('click',e=>{e.preventDefault();showPage('shop')});
    nav.products.addEventListener('click',e=>{e.preventDefault();showPage('products')});
    qs('#bcHome').addEventListener('click',e=>{e.preventDefault();showPage('home')});
    // back button beside heading
    qs('#backBtn').addEventListener('click',()=>{ history.length>1 ? history.back() : showPage('home'); });

    /* ===================== Search ===================== */
    const searchBox=qs("#searchBox"),searchBtn=qs("#searchBtn");
    const searchCat=qs("#searchCat"),searchCatMenu=qs("#searchCatMenu"),searchCatLabel=qs("#searchCatLabel");
    searchCat.addEventListener("click",e=>{e.stopPropagation();toggle(searchCatMenu)});
    searchCatMenu.addEventListener("click",e=>{const li=e.target.closest("li");if(!li)return;searchCatLabel.textContent=li.dataset.value||"All";searchCatMenu.style.display="none"});
    document.addEventListener("click",()=>searchCatMenu.style.display="none");
    function doSearch(){const q=(searchBox.value||"").trim().toLowerCase();const cat=(searchCatLabel.textContent||"All").toLowerCase();
      const filtered=products.filter(p=>{const t=(p.name+" "+(p.brand||"")+" "+(p.category||"")).toLowerCase();const okCat=(cat==="all")?true:String(p.category||"").toLowerCase()===cat;return t.includes(q)&&okCat;});
      showPage('products');renderProducts(filtered,qs('#productsGrid'));
    }
    searchBtn.addEventListener("click",doSearch);
    searchBox.addEventListener("keydown",e=>{if(e.key==="Enter")doSearch()});

    /* ===================== Category dropdown ===================== */
    const allBtn=qs("#allCategoriesBtn");const dropdown=qs("#dropdownMenu");
    allBtn.addEventListener("click",function(e){e.stopPropagation();closeDrawer();dropdown.classList.contains('anim-open')?closeDropdown():openDropdown()});
    document.addEventListener("click",e=>{if(!allBtn.contains(e.target))closeDropdown()});
    dropdown.addEventListener('click',function(e){e.stopPropagation();const item=e.target.closest('.cat-item');if(!item)return;
      if(item.hasAttribute('data-shop')){item.classList.toggle('open');return}
      if(item.classList.contains('has-children')){item.classList.toggle('open');return}
      const cat=item.getAttribute('data-cat');const brand=item.getAttribute('data-brand');
      closeDropdown();showPage('products');
      const out=products.filter(p=>{
        const okCat = cat ? (String(p.category||"").toLowerCase()===cat.toLowerCase()) : true;
        const okBrand = brand ? (String(p.brand||"").toLowerCase()===brand.toLowerCase()) : true;
        return okCat && okBrand;
      });
      renderProducts(out,qs('#productsGrid'));
    });
    function openDropdown(){dropdown.classList.add('anim-open');dropdown.setAttribute("aria-hidden","false");allBtn.setAttribute("aria-expanded","true")}
    function closeDropdown(){dropdown.classList.remove('anim-open');dropdown.style.display="none";dropdown.offsetHeight;dropdown.style.display="";dropdown.setAttribute("aria-hidden","true");allBtn.setAttribute("aria-expanded","false")}

    /* ===================== Wishlist ===================== */
    const WISH_KEY='a2z_wish_v1';
    const wishSet=new Set(JSON.parse(localStorage.getItem(WISH_KEY)||'[]'));
    const wishCountEl=document.getElementById('wishCount');
    const wishIconBtn=document.getElementById('wishIconBtn');
    const wishPop=document.getElementById('wishPop');
    const wishBody=document.getElementById('wishBody');

    function saveWish(){ localStorage.setItem(WISH_KEY, JSON.stringify([...wishSet])); refreshWish(); }

    /* ★ update: sync all product-card heart states with wishlist */
    function updateProductHeartStates(){
      document.querySelectorAll('.product-card').forEach(card=>{
        const id = card.getAttribute('data-pid');
        const btn = card.querySelector('.wish-btn');
        if(btn && id){ btn.classList.toggle('active', wishSet.has(id)); }
      });
    }

    function refreshWish(){
      wishCountEl.textContent=wishSet.size;
      // header heart color
      wishIconBtn.classList.toggle('has-wish', wishSet.size>0);
      // rebuild popover list
      wishBody.innerHTML='';
      if(wishSet.size===0){
        wishBody.innerHTML='<div style="padding:12px;color:#7c8aa3;text-align:center">No items in wishlist.</div>';
      }else{
        [...wishSet].forEach(id=>{
          const p=byId(id); if(!p) return;
          const row=document.createElement('div'); row.className='wish-pop row';
          row.innerHTML=`<img src="${p.image}" alt=""><div><div class="title">${escapeHtml(p.name)}</div><div style="font-size:12px;color:#566074">${fmt(p.discountPrice||p.regularPrice)}</div></div><button class="rm" data-id="${p.id}"><i class="fa fa-trash"></i></button>`;
          wishBody.appendChild(row);
        });
      }
      /* ★ update: ensure product page wish buttons reflect any add/remove done elsewhere */
      updateProductHeartStates();
    }

    // toggle popover
    wishIconBtn.addEventListener('click',(e)=>{e.stopPropagation(); wishPop.classList.toggle('show'); wishPop.setAttribute('aria-hidden', wishPop.classList.contains('show')?'false':'true');});
    document.addEventListener('click',()=>{ wishPop.classList.remove('show'); wishPop.setAttribute('aria-hidden','true'); });
    // remove from popover
    wishBody.addEventListener('click',e=>{
      const btn=e.target.closest('.rm'); if(!btn) return;
      const id=btn.getAttribute('data-id');
      if(wishSet.has(id)){ wishSet.delete(id); saveWish(); /* refreshWish() already calls updateProductHeartStates() */ }
    });

    /* ===================== Products grid ===================== */
    function renderProducts(list,mount){
      const grid=mount; grid.innerHTML="";
      if(!list||list.length===0){grid.innerHTML='<div style="grid-column:1/-1;padding:20px;text-align:center;color:#666">No products found</div>';return;}
      list.forEach(p=>{
        const card=document.createElement("article");card.className="product-card";
        card.setAttribute('data-pid', p.id); /* ★ update: store id for sync */
        const safeName = escapeHtml(p.name);
        const featureHTML = (p.features||[]).slice(0,4).map(f=>`<li>${escapeHtml(f)}</li>`).join("");
        card.innerHTML = `
          <a class="product-image" href="${PRODUCT_PAGE_URL}?id=${p.id}" target="_self" title="Display Product">
            <img src="${p.image}" alt="${safeName}" loading="lazy" draggable="false">
            <button class="wish-btn" type="button" aria-label="Wishlist"><i class="fa-solid fa-heart"></i></button>
          </a>
          <div class="divider"></div>
          <a class="product-title" href="${PRODUCT_PAGE_URL}?id=${p.id}" target="_self" title="Display Product">${safeName}</a>
          <ul class="feature-list">${featureHTML}</ul>
          <div class="divider"></div>
          <div class="product-bottom">
            <div class="price-area">
              <div class="regular-price">${fmt(p.regularPrice||0)}</div>
              <div class="discount-price">${fmt(p.discountPrice||p.regularPrice||0)}</div>
            </div>
            <div class="product-actions">
              <button class="btn btn-blue" type="button"><i class="fa fa-cart-plus"></i><span>Add to Cart</span></button>
              <a class="btn btn-view" href="${PRODUCT_PAGE_URL}?id=${p.id}" target="_self"><span>View Details</span></a>
            </div>
          </div>`;
        if(!p.discountPrice || p.discountPrice>=p.regularPrice){card.querySelector('.regular-price').style.display='none'}

        // add to cart
        const btnCart = card.querySelector('.btn-blue');
        btnCart.onclick = ()=>{ addToCart(p.id,1,{open:false,toast:true}); };

        // wishlist toggle
        const wbtn=card.querySelector('.wish-btn');
        const setBtn=()=>wbtn.classList.toggle('active', wishSet.has(p.id));
        setBtn();
        wbtn.addEventListener('click',(e)=>{
          e.preventDefault();
          if(wishSet.has(p.id)) wishSet.delete(p.id); else wishSet.add(p.id);
          saveWish(); setBtn();
        });

        grid.appendChild(card);
      });
    }

    /* ===================== CART (persist) ===================== */
    const CART_KEY='a2z_cart_v2';
    const cartMap=JSON.parse(localStorage.getItem(CART_KEY) || '{}');

    function saveCart(){localStorage.setItem(CART_KEY, JSON.stringify(cartMap))}
    function calcTotals(){let items=0,total=0;for(const k in cartMap){items+=cartMap[k].qty;total+=cartMap[k].qty*cartMap[k].unit}return {items,total}}

    const cartCountEl=qs('#cartCount'), cartTotalEl=qs('#cartTotal');
    const toast=qs('#cartToast');

    function showToast(){
      toast.classList.remove('show'); void toast.offsetWidth;
      toast.classList.add('show');
      setTimeout(()=>toast.classList.remove('show'), 2200);
    }

    function addToCart(id,qty=1,opt={open:false,toast:false}){
      const prod=byId(id); if(!prod) return;
      if(!cartMap[id]) cartMap[id]={prod,qty:0,unit:unitPrice(prod)};
      cartMap[id].qty += qty;
      saveCart(); refreshCartEverywhere();
      if(opt.open) openDrawer();
      if(opt.toast) showToast();
    }
    function setQty(id,qty){
      if(qty<=0){ delete cartMap[id]; }
      else {
        if(!cartMap[id]) cartMap[id]={prod:byId(id),qty:0,unit:unitPrice(byId(id))};
        cartMap[id].qty=qty;
      }
      saveCart(); refreshCartEverywhere();
    }
    function removeItem(id){ delete cartMap[id]; saveCart(); refreshCartEverywhere(); }

    /* ===================== Drawer ===================== */
    const overlay=qs('#overlay'), drawer=qs('#drawer'), drBody=qs('#drBody'), drSubtotal=qs('#drSubtotal'), drCount=qs('#drCount');
    const cartBtn=qs('#cartBtn');

    function openDrawer(){ renderDrawer(); overlay.classList.add('show'); drawer.classList.add('open'); drawer.setAttribute('aria-hidden','false'); cartBtn.setAttribute('aria-expanded','true'); document.body.style.overflow='hidden'; }
    function closeDrawer(){ overlay.classList.remove('show'); drawer.classList.remove('open'); drawer.setAttribute('aria-hidden','true'); cartBtn.setAttribute('aria-expanded','false'); document.body.style.overflow=''; }
    function renderDrawer(){
      const ids=Object.keys(cartMap);
      const {items,total}=calcTotals();
      cartCountEl.textContent=items;
      cartTotalEl.textContent=fmt(total);
      drCount.textContent=items;
      drSubtotal.textContent=fmtTk(total);
      if(ids.length===0){ drBody.innerHTML='<div style="padding:14px;color:#7c8aa3;text-align:center">Your cart is empty.</div>'; return; }
      drBody.innerHTML="";
      ids.forEach(id=>{
        const {prod,qty,unit}=cartMap[id];
        const div=document.createElement('div'); div.className='mc-item';
        div.innerHTML=`<div class="mc-thumb"><img src="${prod.image}" alt=""></div>
          <div class="mc-meta"><div class="mc-title">${escapeHtml(prod.name)}</div>
          <div class="mc-line">${fmtTk(unit)} × <span>${qty}</span> = <strong>${fmtTk(unit*qty)}</strong></div></div>
          <div><input class="qty-input" type="number" min="0" step="1" value="${qty}"><div class="mc-remove" title="Remove"><i class="fa fa-trash"></i></div></div>`;
        div.querySelector('input').addEventListener('input',()=>setQty(id, parseInt(div.querySelector('input').value||"0",10)||0));
        div.querySelector('.mc-remove').addEventListener('click',()=>removeItem(id));
        drBody.appendChild(div);
      });
    }
    cartBtn.addEventListener('click',e=>{e.preventDefault(); drawer.classList.contains('open')?closeDrawer():openDrawer();});
    qs('#drawerClose').addEventListener('click',closeDrawer);
    overlay.addEventListener('click',closeDrawer);
    qs('#viewCartFromDrawer').addEventListener('click',()=>{ closeDrawer(); showPage('cart'); });

    function refreshCartEverywhere(){ renderDrawer(); renderCartPage(); }

    /* ===================== Cart Page ===================== */
    const cpRows=qs('#cpRows'), cpCount=qs('#cpCount'),
          pdRegular=qs('#pdRegular'), pdTotal=qs('#pdTotal'), pdDisc=qs('#pdDisc'), pdShip=qs('#pdShip'), pdAfter=qs('#pdAfter');
    const checkAll=qs('#checkAll'), bulkDelete=qs('#bulkDelete'), btnCheckout=qs('#btnCheckout');

    qs('#btnContinue').addEventListener('click',()=>showPage('products'));

    bulkDelete.addEventListener('click',()=>{
      const ids=Object.keys(cartMap);
      const rowChecks=[...cpRows.querySelectorAll('.row-check')];
      rowChecks.forEach((cb,i)=>{ if(cb.checked){ const id=ids[i]; if(id) delete cartMap[id]; }});
      saveCart(); refreshCartEverywhere();
    });

    function renderCartPage(){
      const ids=Object.keys(cartMap);
      cpRows.innerHTML="";
      cpCount.textContent=ids.reduce((s,id)=>s+cartMap[id].qty,0);

      ids.forEach(id=>{
        const {prod,qty,unit}=cartMap[id];
        const row=document.createElement('div'); row.className='cart-row';
        row.innerHTML=`
          <input type="checkbox" class="row-check">
          <img src="${prod.image}" alt="">
          <div>
            <div style="font-weight:700;margin-bottom:6px">${escapeHtml(prod.name)}</div>
            <div style="color:#555">${fmtTk(unit)}</div>
          </div>
          <div style="display:flex;align-items:center;gap:20px;justify-content:flex-end">
            <div class="cart-qty">
              <button class="minus">-</button>
              <input type="text" class="qty" value="${qty}">
              <button class="plus">+</button>
            </div>
            <div class="row-price"><strong>${fmtTk(unit*qty)}</strong></div>
          </div>
          <button class="trash-btn" title="Remove"><i class="fa fa-trash"></i></button>`;

        const qtyInput=row.querySelector('.qty');
        row.querySelector('.minus').addEventListener('click',()=>{const v=Math.max(0,parseInt(qtyInput.value||"0",10)-1);qtyInput.value=v;setQty(id,v)});
        row.querySelector('.plus').addEventListener('click',()=>{const v=(parseInt(qtyInput.value||"0",10)+1);qtyInput.value=v;setQty(id,v)});
        qtyInput.addEventListener('input',()=>{const v=parseInt(qtyInput.value||"0",10)||0;setQty(id,v)});
        row.querySelector('.trash-btn').addEventListener('click',()=>removeItem(id));

        cpRows.appendChild(row);
      });

      checkAll.checked=false;
      updateSelectionAndTotals();
    }

    function updateSelectionAndTotals(){
      const ids=Object.keys(cartMap);
      const rowChecks=[...cpRows.querySelectorAll('.row-check')];
      let regular=0, disc=0, anyChecked=false;

      rowChecks.forEach((cb,i)=>{
        if(cb.checked){
          anyChecked=true;
          const id=ids[i]; if(!id) return;
          const {prod,qty,unit}=cartMap[id];
          const base = (prod.regularPrice||unit);
          regular += base * qty;
          const d = Math.max(base - unit,0) * qty;
          disc += d;
        }
      });

      const after = Math.max(regular - disc, 0);
      const shipping = anyChecked ? 150 : 0;
      const total = after + shipping;

      pdRegular.textContent = fmtTk(regular);
      pdDisc.textContent    = fmtTk(disc);
      pdAfter.textContent   = fmtTk(after);
      pdShip.textContent    = fmtTk(shipping);
      pdTotal.textContent   = fmtTk(total);

      btnCheckout.disabled = !anyChecked;
      btnCheckout.classList.toggle('btn-disabled', !anyChecked);
    }

    checkAll.addEventListener('change',()=>{
      cpRows.querySelectorAll('.row-check').forEach(cb=>cb.checked=checkAll.checked);
      updateSelectionAndTotals();
    });
    cpRows.addEventListener('change',e=>{
      if(e.target.classList.contains('row-check')){
        const boxes=[...cpRows.querySelectorAll('.row-check')];
        checkAll.checked = (boxes.length>0 && boxes.every(cb=>cb.checked));
        updateSelectionAndTotals();
      }
    });

    btnCheckout.addEventListener('click',()=>{
      if(btnCheckout.disabled) return;
      showPage('address');
    });

    /* ===================== HOME slider init ===================== */
    const HB_CONFIG = {
      main: [
        { src: "https://static.vecteezy.com/system/resources/previews/011/871/820/non_2x/online-shopping-on-phone-buy-sell-business-digital-web-banner-application-money-advertising-payment-ecommerce-illustration-search-vector.jpg", link: "#", alt: "Starlink – stock ready" },
        { src: "https://www.shutterstock.com/image-vector/3d-yellow-great-discount-sale-260nw-2056851839.jpg", link: "#", alt: "New laptops" },
        { src: "https://static.vecteezy.com/system/resources/previews/002/006/774/non_2x/paper-art-shopping-online-on-smartphone-and-new-buy-sale-promotion-backgroud-for-banner-market-ecommerce-free-vector.jpg", link: "#", alt: "Gaming festival" },
      ],
      rightTop:    { src: "https://www.startech.com.bd/image/catalog/home/job-career-2024.webp", link: "#", alt: "0% EMI" },
      rightBottom: { src: "https://t4.ftcdn.net/jpg/06/40/64/53/360_F_640645306_ADDT2XPJVYKhd1tIkqZF2vK1MZX4aSb3.jpg", link: "#", alt: "Headphone sale" }
    };

    (function initHB(cfg){
      const track = document.getElementById("hbTrack");
      if(!track) return;
      const btnPrev = document.getElementById("hbPrev");
      const btnNext = document.getElementById("hbNext");
      const N = cfg.main.length; if(N===0) return;

      const slides = [];
      slides.push(cfg.main[N-1]); cfg.main.forEach(s=>slides.push(s)); slides.push(cfg.main[0]);
      slides.forEach(item=>{ const a=document.createElement("a"); a.className="hb-slide"; a.href=item.link||"#"; a.target="_self"; a.innerHTML=`<img src="${item.src}" alt="${item.alt||""}">`; track.appendChild(a); });

      const rt = document.getElementById("hbRightTop");
      const rb = document.getElementById("hbRightBottom");
      rt.href = cfg.rightTop.link;   rt.querySelector("img").src = cfg.rightTop.src;   rt.querySelector("img").alt = cfg.rightTop.alt;
      rb.href = cfg.rightBottom.link;rb.querySelector("img").src = cfg.rightBottom.src;rb.querySelector("img").alt = cfg.rightBottom.alt;

      const DURATION=600, STEP_MS=5000; let index=1, timer=null, locked=false;
      function setTransition(on){ track.style.transition = on ? `transform ${DURATION}ms ease` : "none"; }
      function applyTransform(){ track.style.transform = `translateX(-${index*100}%)`; }
      function go(i,withTransition=true){ if(locked) return; locked=true; setTransition(withTransition); index=i; applyTransform(); }
      function afterTransition(){
        if(index===slides.length-1){ setTransition(false); index=1; applyTransform(); track.getBoundingClientRect(); setTransition(true);}
        else if(index===0){ setTransition(false); index=slides.length-2; applyTransform(); track.getBoundingClientRect(); setTransition(true);}
        locked=false;
      }
      setTransition(false); applyTransform(); setTransition(true);
      function startAuto(){ stopAuto(); timer=setInterval(()=>go(index+1,true),STEP_MS); }
      function stopAuto(){ if(timer){clearInterval(timer); timer=null;} }
      startAuto();
      btnNext.addEventListener('click', ()=>{ stopAuto(); go(index+1,true); setTimeout(startAuto, STEP_MS); });
      btnPrev.addEventListener('click', ()=>{ stopAuto(); go(index-1,true); setTimeout(startAuto, STEP_MS); });
      track.addEventListener('mouseenter', stopAuto);
      track.addEventListener('mouseleave', startAuto);
      track.addEventListener('transitionend', afterTransition);
    })(HB_CONFIG);

    /* ===================== Util ===================== */
    function qs(s,root=document){return root.querySelector(s)}
    function toggle(el){el.style.display=(el.style.display==='block'?'none':'block')}
    function escapeHtml(s){return (s||'').replace(/[&<>"']/g,m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[m]))}

    /* ===================== Init ===================== */
    // restore last page on reload
    (function restoreLast(){
      const last = localStorage.getItem(LAST_PAGE_KEY);
      if(last && pages[last]){ Object.values(pages).forEach(p=>p.classList.remove('show')); pages[last].classList.add('show'); Object.values(nav).forEach(a=>a.classList.remove('active')); if(nav[last]) nav[last].classList.add('active'); if(last==='products') renderProducts(products, qs('#productsGrid')); if(last==='cart') renderCartPage(); }
      else{ renderProducts(products, qs('#productsGrid')); }
    })();

    refreshCartEverywhere();
    refreshWish();
  </script>
</body>
</html>
